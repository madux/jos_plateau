<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        
        <record id ="memo_model_form_view_3" model ="ir.ui.view">
            <field name="name">Memo Record</field>
            <field name="model">memo.model</field>
            <!-- <field name="context">{'form_no_edit':[('user_ids','in', ['res_users'])]}</field>  -->
            <field eval="1" name="priority"/>
            <field name ="arch" type="xml">
                <form string="Memo Record">
                <header>
                    <button name="forward_memo" id="forward_memo" string="Forward / Approve" icon="fa-forward" attrs="{'invisible':['|', ('state','in',['Done','Refuse']),('user_is_approver','=',True)]}" type="object" class="oe_highlight fwm"/>
                    <button name="approve_memo" string="Approve" type="object" class="oe_highlight" attrs="{'invisible': ['|', '|', ('memo_type_key','not in',['soe', 'leave_request', 'cash_advance', 'loan', 'Payment', 'server_access', 'material_request', 'procurement_request', 'vehicle_request','employee_update', 'Internal']),('state','in',['submit', 'Approve','Done','Refuse']), ('user_is_approver','!=',True)]}"/>
                    <!-- <button name="update_inventory_product_quantity" string="Update Inventory Items" type="object" class="oe_highlight" confirm="Are you sure you want to Retire inventory items?" attrs="{'invisible':['|','|', ('state','not in',['Approve','Done']), ('memo_type_key','not in',['soe']),('user_is_approver','=', False)]}"/> -->
                    <button name="generate_recruitment_request" attrs="{'invisible': ['|', '|', ('memo_type_key','not in',['recruitment_request']),('state','not in',['Done', 'Approve2']), ('user_is_approver','!=',True)]}" string="View / Generate Recruitment Request" type="object" class="oe_highlight"/>
                    <button name="action_post_and_vallidate_payment" string="Register Payment" type="object" class="oe_highlight" confirm="Are you sure you want to make Payment?" attrs="{'invisible':['|','|', '|',('user_is_approver','!=',True), ('state','not in',['Approve']), ('memo_type_key','not in',['Payment']),('is_request_completed','=', True)]}"/>
                    <button name="send_memo_to_contacts" string="Send Memo" type="object" class="oe_highlight" confirm="Are you sure you want to make send memo?" attrs="{'invisible':['|','|', '|', ('user_is_approver','!=',True), ('state','not in',['Approve2']), ('memo_type_key','not in',['internal', 'Internal']), ('internal_memo_option','not in',['all', 'selected'])]}"/>
                    <button name="complete_memo_transactions" string="Generate &amp; Confirm Entries" type="object" class="oe_highlight" confirm="Are you sure you want to generate?" attrs="{'invisible':['|','|','|',('state','not in',['Done']),('is_request_completed','=', True), ('memo_type_key','not in',['material_request', 'procurement_request', 'vehicle_request']),('user_is_approver','=', False)]}"/>
                    <button name="generate_move_entries" string="Create &amp; Post Cash Advance Entry" type="object" class="oe_highlight" confirm="Are you sure you want to generate?" attrs="{'invisible':['|','|', ('state','not in',['Approve', 'Done']), ('memo_type_key','not in',['cash_advance']),('user_is_approver','=', False)]}"/>
                    <button name="generate_soe_entries" string="Retire Expense" type="object" class="oe_highlight" confirm="Are you sure you want to Retire?" attrs="{'invisible':['|','|', ('state','not in',['Approve','Done']), ('memo_type_key','not in',['soe']),('user_is_approver','=', False)]}"/>
                    <button name="generate_loan_entries" string="Generate Loan Entry" type="object" class="oe_highlight" confirm="Are you sure you want to generate a loan entry?" groups="base.group_system,company_memo.mainmemo_account,account.group_account_manager" attrs="{'invisible':['|',('state','not in',['Done']),('memo_type_key','not in',['loan'])]}"/>
                    <button name="set_draft" states="Refuse" string="ReSet &amp; Forward" type="object" class="btn-primary"/>
                    <button name="return_memo" id="return_id" string="Return Memo" icon="fa-redo" attrs="{'invisible': [('state','not in',['Sent', 'Approve','Approve2'])]}" type="object"/>
                    <button name="Cancel" states="Sent" string="Cancel" type="object" attrs="{'invisible':[('state','!=',['sent'])]}" />
                    <button name="print_memo" string="Print Memo" icon="fa-print" attrs="{'invisible':[('state','in',['Sent', 'Refuse'])]}" type="object" class="oe_highlight"/>
                    <field name="computed_stage_ids" invisible="1" />
                    <field name="stage_id" widget="statusbar" force_save="1" readonly="1" domain="[('id', 'in', computed_stage_ids)]" />
                </header>
                    <sheet>
                                    <!-- icon="fa-redo" -->
                        <div class="row">
                            <div class="col-xs-4 pull-left mt8">
                                <button name="return_memo"
                                    class="btn-danger oe_stat_button sm"
                                    attrs="{'invisible': ['|', '|',('memo_type_key','not in',['Internal','server_access','employee_update', 'material_request', 'procurement_request', 'cash_advance', 'soe', 'vehicle_request']),('state','!=','Sent'),('user_is_approver','!=', True)]}"
                                    type="object" string="Refuse"
                                    confirm="Are you sure you want to refuse with comments?">
                                </button>
                            </div> 
                        </div>
                        <br/>
                        <div class="oe_button_box oe_right">
                            <button name="action_get_attachment_view"
                                class="oe_highlight"
                                icon="fa-book" 
                                type="object">
                                <field name="attachment_number" widget="statinfo" string=" - Documents"/>
                            </button>
                            <button name="view_related_record"
                                class="btn-primary oe_highlight"
                                attrs="{
                                    'invisible': [('state','in',['Sent', 'submit', 'Refuse'])]}"
                                type="object" string="View Related Record"/>
                                 
                        </div>
                        <div class="oe_title">
                        <label for="name"/>
                            <h1 style="color:Tomato;">
                                <field name="name" required="1" placeholder="e.g. Description" attrs="{'readonly':[('state','not in',['submit'])]}"/>
                            </h1>
                        </div>
                        <group>
                            <group> 
                                <label for="memo_type"/>
                                <div>
                                    <field name="memo_type" required="1" attrs="{'readonly':[('state','not in',['submit'])]}" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
                                    <!-- <field name="memo_type_key" string="Memo key" invisible="1" force_save="1"/>  -->
                                </div>
                            </group> 
                            <group>
                            </group>
                            <group name="normal_memo_group1">
                    <!-- MEMO THINGS -->
                                <field name = "internal_memo_option" string="Memo Option" 
                                    attrs="{'invisible': ['|',('memo_type_key', 'not in', ['Internal', 'internal']), ('to_create_document', '=', True)], 'readonly':[('state','not in',['submit'])]}" readonly="0"/>

                                 <field name = "partner_ids" string="Reciepients" widget="many2many_tags" 
                                attrs="{'readonly':[('state','not in',['submit'])], 'invisible': [('internal_memo_option', 'not in', ['selected'])], 'required': [('user_is_approver', '=', True),('internal_memo_option', '=', 'selected'), ('memo_type_key', 'in', ['Internal', 'internal'])]}" 
                                options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/> 
                    <!-- MEMO THINGS -->
                                <field name="client_id" attrs="{'readonly':[('state','not in',['submit'])]}" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" /> 
                                <field name="employee_id" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" readonly="1"/>
                                <!-- attrs="{'readonly':[('state','not in',['submit'])]}"/> -->
                                <field name="phone" readonly="1"/>
                                <field name="email" readonly="1"/>
                                <field name="memo_setting_id" invisible="1" force_save="1" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
                                <field name="direct_employee_id" required="0" invisible="1" string= "Through" attrs="{'readonly':[('state','in',['Done', 'Approve'])]}"/>
                                <field name="set_staff" string = "Memo With" readonly="1" invisible="1"/>
                                <field name="demo_staff" invisible="1"/>

                                <field name="dept_ids" widget="selection" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" readonly="1"/>
                                <field name="loan_type" attrs="{'invisible':[('memo_type_key','!=','loan')], 'required':[('memo_type_key','=','loan')]}"/>
                                <field name="loan_amount" attrs="{'invisible':[('memo_type_key','!=','loan')],'required':[('memo_type_key','=','loan')]}"/>
                                <field name="periods" attrs="{'invisible':[('memo_type_key','!=','loan')],'required':[('memo_type_key','=','loan')]}"/>
                                <field name="method_period" attrs="{'invisible':[('memo_type_key','!=','loan')],'required':[('memo_type_key','=','loan')]}"/>
                                <field name="start_date" attrs="{'invisible':[('memo_type_key','!=', 'loan')],'required':[('memo_type_key','=','loan')]}"/>
                                <field name="cash_advance_reference" domain="[('state', '=', 'Done')]" attrs="{'invisible':[('memo_type_key','!=', 'soe')],'required':[('memo_type_key','=','soe')]}"/>
                                <field name="soe_advance_reference" attrs="{'invisible':[('memo_type_key','!=', 'cash_advance')]}"/>
                                <field name="currency_id" invisible="1"/>
                                <field name="move_id" invisible="1"/>
                                <field name = "users_followers" widget="many2many_tags" required="0" invisible="0" attrs="{'readonly':[('state','in',['Done', 'Approve'])]}" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
                                <field name = "res_users" widget="many2many_tags" required="0" readonly="1"/>  
                                <field name="active" invisible="1" groups="base.group_system"/>
                                <field name="memo_type_key" string="Memo key" invisible="1" force_save="1"/> 
                                <field name="has_sub_stage" invisible="1"/> 
                            </group> 
                            <group name="normal_memo_group2"> 
                                <field name="date" attrs="{'readonly':[('state','not in',['submit'])]}" options='{"datepicker": {"daysOfWeekDisabled": [5,6]}}'/>
                                <field name="date_deadline" attrs="{'readonly':[('state','not in',['submit'])], 'invisible':[('memo_type_key','not in',[['material_request','procurement_request']])]}"/>
                                <field name="leave_type_id"  options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" attrs="{'required':[('memo_type_key','in',['leave_request'])], 'invisible':[('memo_type_key','not in',['leave_request'])], 'readonly':[('state','not in',['submit'])]}"/>
                                <field name="leave_start_date" widget="daterange" options='{"related_end_date": "leave_end_date", "datepicker": {"daysOfWeekDisabled": [5, 6]}}' attrs="{'required':[('memo_type_key','in',['leave_request'])],'invisible':[('memo_type_key','not in',['leave_request'])], 'readonly':[('state','not in',['submit'])]}"/>
                                <field name="leave_end_date" attrs="{'required':[('memo_type_key','in',['leave_request'])], 'invisible':[('memo_type_key','not in',['leave_request'])],'readonly':[('state','not in',['submit'])]}"/>
                                <field name="user_ids" readonly="1" invisible="1" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" />
                                <field name="amountfig" string="Amount" readonly="1" attrs="{'invisible':[('memo_type_key','not in',['Payment'])]}"/>
                                <field name="project_id" attrs="{'readonly':[('state','not in',['submit'])]}" invisible="1" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" />
                                <field widget="binary" height="64" name="file_upload" filename="file_namex" required="0" invisible="1" string="Upload File" />
                                <field name="file_namex" invisible="1"/> 
                                <field name="to_create_document" invisible="1"/> 
                                <field name="memo_category_id" attrs="{'invisible':[('to_create_document','!=', True)], 'readonly':[('state','not in',['submit'])]}"
                                options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/> 
                                <field name="document_folder" attrs="{'invisible':[('to_create_document','!=', True)], 'required':[('to_create_document','=', True)],'readonly':[('state','not in',['submit'])]}"
                                options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
                                <!-- <field name = "employee_ids" string="Employee Reciepients" 
                                widget="many2many_tags" attrs="{'invisible': [('internal_memo_all_employee_option', '!=', 'employees')], 'required': [('internal_memo_all_employee_option', '=', 'employee')]}" 
                                invisible="0" readonly="0" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" />  -->
                                <field name="status_progress" widget="progressbar" string="Progress(%)"/>
                                <field name="code"/>  
                                <field name="approver_id" invisible="1" readonly="0" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" groups="base.group_system"/>
                                <field name="approver_ids" invisible="1" widget="many2many_tags" readonly="0" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" groups="base.group_system"/>
                                <field name="user_is_approver" invisible="1" readonly="0"/>
                                <field name="state" invisible="1" force_save="1" readonly="0"/>
                                <field name="is_request_completed" readonly="1" invisible="1"/>
                            </group> 
                        </group>
                        <notebook>
                            <page name='description' string='Memo Body'>
                                <field name="description" string = "More Notes" placeholder="Notes..." widget="html" attrs="{'readonly':[('state','in',['Done', 'Approve'])]}"/>
                            </page> 
                            <page name='Products' string='Request item' attrs="{'invisible':[('memo_type_key','not in',['Payment', 'material_request', 'procurement_request', 'cash_advance', 'soe', 'vehicle_request'])]}">
                                <field name="product_ids" string = "Items" 
                                attrs="{'readonly':[('state','in',['Done'])]}"
                                context="{'default_state': state, 'default_memo_type': memo_type, 'default_memo_type_key': memo_type_key}"
                                options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}">
                                    <tree string="Items" editable="bottom">
                                        <field name="state" string="State" invisible="1"/> 
                                        <field name="memo_type_key" string="memo key" invisible="1" force_save="1"/> 
                                        <field name="to_retire" string="To Retire" attrs="{'invisible': [('memo_type_key', 'not in', ['soe'])]}"/> 
                                        <!-- <field name="district_id" string="District" invisible="1"/>  -->
                                        <field name="memo_id" string="Memo" invisible="1" force_save="1"/> 
                                        <field name="memo_type" string="Memo type" invisible="1" force_save="1"/> 
                                        <field name="product_id" string="Product" force_save="1"
                                         attrs="{'readonly':[('state','not in',['draft'])],'required':[('memo_type_key','in',['material_request', 'procurement_request', 'cash_advance', 'soe', 'vehicle_request'])], 
                                         'column_invisible': [('memo_type_key', 'in', ['Payment','Internal', 'leave_request', 'loan'])]}"/> 
                                        <field name="description" string="Description" force_save="1" invisible="0" attrs="{'readonly':[('state','not in',['draft'])],'required': [('product_id', '=', False)]}"/> 
                                        <field name="code" string="Code" readonly="1" force_save="1" attrs="{'readonly':[('state','not in',['draft'])], 'column_invisible': [('memo_type_key', 'in', ['Payment','Internal', 'leave_request', 'loan'])]}"/> 
                                        <field name="quantity_available" string="Request Qty" force_save="1" sum="Total" attrs="{'readonly':[('state','not in',['draft'])], 'column_invisible': [('memo_type_key', 'in', ['Payment','Internal', 'leave_request', 'loan'])]}"/> 
                                        <field name="amount_total" string="Unit Price" force_save="1" sum="Total" attrs="{'readonly':[('state','not in',['draft'])], 'invisible': [('memo_type_key', 'not in', ['Payment','recruitment_request', 'soe', 'employee_update', 'material_request', 'cash_advance'])]}"/>
                                        <field name="sub_total_amount"  readonly="1" force_save="1" string="Subtotal" sum="Total" attrs="{'invisible': [('memo_type_key', 'not in', ['Payment','recruitment_request', 'soe', 'employee_update', 'material_request', 'cash_advance'])]}"/>
                                        <field name="used_qty" string="Used Qty" force_save="1" attrs="{'readonly': ['|', ('memo_type_key', 'not in', ['soe']),('state','in',['draft'])], 'invisible': [('memo_type_key', 'not in', ['soe'])], 'column_invisible': [('memo_type_key', 'in', ['soe'])]}"/> 
                                        <field name="used_amount" string="Used Amount" force_save="1" attrs="{'readonly': ['|', ('memo_type_key', 'not in', ['soe']),('state','in',['draft'])], 'invisible': [('memo_type_key', 'not in', ['soe'])], 'column_invisible': [('memo_type_key', 'in', ['soe'])]}"/> 
                                        <field name="note" string="Note" invisible="0" force_save="1"/> 
                                        <field name="driver_assigned" string="Driver" force_save="1" attrs="{'column_invisible': [('memo_type_key', 'not in', ['vehicle_request'])], 'invisible': [('memo_type_key', 'not in', ['vehicle_request'])]}"/> 
                                        <field name="source_location_id" string="Source Location" force_save="1" attrs="{'readonly':[('state','not in',['draft'])], 'column_invisible': [('memo_type_key', 'not in', ['recruitment_request', 'soe', 'employee_update', 'material_request', 'cash_advance', 'server_access'])]}"/> 
                                        <field name="dest_location_id" string="Destination Location" force_save="1" attrs="{'readonly':[('state','not in',['draft'])], 'column_invisible': [('memo_type_key', 'not in', ['recruitment_request', 'soe', 'employee_update', 'material_request', 'cash_advance', 'server_access'])]}"/>
                                        <field name="distance_from" string="From" force_save="1" attrs="{'readonly':[('state','not in',['draft'])], 
                                        'column_invisible': [('memo_type_key', 'not in', ['vehicle_request'])], 'invisible': [('memo_type_key', 'not in', ['vehicle_request'])]}"/> 
                                        <field name="distance_to" string="To" force_save="1" attrs="{'readonly':[('state','not in',['draft'])], 
                                        'column_invisible': [('memo_type_key', 'not in', ['vehicle_request'])], 'invisible': [('memo_type_key', 'not in', ['vehicle_request'])]}"/> 
                                        <field name="retired" string="Retired" force_save="1" attrs="{'column_invisible': [('memo_type_key', 'not in', ['soe'])]}"/>
                                    </tree>
                                </field>
                            </page>
                            <!--ADDD-->
                            <page name='Invoices' string='Invoices'>
                             <!-- attrs="{'invisible':[('memo_type_key','!=','Payment')]}"> -->
                                <field name="invoice_ids" context="{'default_move_type': 'in_invoice', 'default_memo_id': active_id}" domain="[('state', '=', 'draft')]" attrs="{'readonly':[('state','in',['Sent', 'Done', 'Approve2'])]}">
                                    <tree string="Invoices">
                                        <field name="memo_id" string="Memo" invisible="1"/>  
                                        <field name="memo_state" string="Memo state" invisible="1"/>  
                                        <field name="name" string="Description" invisible="0"/>  
                                        <field name="partner_id" string="Partner" invisible="0"/> 
                                        <field name="move_type" string="Type" invisible="0"/> 
                                        <field name="ref" string="Ref" invisible="0"/>  
                                        <field name="date" string="Date" invisible="0"/> 
                                        <field name="payment_journal_id" string="Payment journal" required="0"/>  
                                        <field name="amount_total" string="Amount" invisible="0"/> 
                                        <field name="state" string="Status" invisible="0"/> 
                                        <field name="stage_invoice_name" invisible="1" column_invisible="1"/> 
                                        <button name="action_post" string="Post" class="oe_highlight btn-sm" type="object" attrs="{'invisible':[('memo_state','not in',['Approve'])]}" 
                                        groups="account.group_account_invoice,base.group_system,company_memo.mainmemo_account,account.group_account_manager"/>
                                        <field name="payment_state" string="Payment Status" invisible="0"/>  
                                        <button name="action_register_payment" id="account_invoice_payment_btn" type="object" class="oe_highlight btn-sm"
                                         attrs="{'invisible': ['|', '|', '|', ('memo_state','not in',['Approve']), ('state', '!=', 'posted'), ('payment_state', '!=', 'not_paid'), ('move_type', 'not in', ('out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'))]}" string="Register Payment" groups="account.group_account_invoice,base.group_system,company_memo.mainmemo_account,account.group_account_manager"/>
                                    </tree>
                                </field>
                            </page>
                            <!--ADDD-->
                            <page name='rr_form' string='Recruitment Request form' attrs="{'invisible':[('memo_type_key','not in',['recruitment_request'])]}">
                                <form string="Items"> 
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="requested_department_id" 
                                                string="Requesting Department" 
                                                attrs="{'required':[('memo_type_key','in',['recruitment_request'])], 'readonly': [('state', '!=', 'submit')]}"
                                                options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/> 
                                                <field name="job_tmp" attrs="{'required':[('memo_type_key','in',['recruitment_request'])], 'readonly': [('state', '!=', 'submit')]}"/> 
                                                <field name="job_id" string="Job Position" 
                                                attrs="{'invisible':[('state','not in',['Done', 'Approve', 'Approve2'])], 'required':[('memo_type_key','in',['recruitment_request']), ('state','in',['Done', 'Approve', 'Approve2'])]}"/> 
                                                <field name="established_position" 
                                                attrs="{'readonly': [('state', '!=', 'submit')],'required':[('memo_type_key','in',['recruitment_request'])]}"/> 
                                                <field name="recruitment_mode" string="Recruitment Mode" 
                                                attrs="{'readonly': [('state', '!=', 'submit')],'required':[('memo_type_key','in',['recruitment_request'])]}"/> 
                                                <field name="qualification" string="Qualification" 
                                                attrs="{'readonly': [('state', '!=', 'submit')], 'required':[('memo_type_key','in',['recruitment_request'])]}"/> 
                                                <field name="age_required" string="Required Age" attrs="{'required':[('memo_type_key','in',['recruitment_request'])], 'readonly': [('state', 'not in', ['submit', None])]}"/> 
                                            </group>
                                            <group>
                                                <field name="years_of_experience" attrs="{'readonly': [('state', '!=', 'submit')],'required':[('memo_type_key','in',['recruitment_request'])]}"/> 
                                                <field name="expected_employees" attrs="{'readonly': [('state', '!=', 'submit')],'required':[('memo_type_key','in',['recruitment_request'])]}"/> 
                                                <field name="recommended_by" attrs="{'readonly': [('state', '!=', 'submit')]}" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>
                                                 <!-- attrs="{'required':[('memo_type_key','in',['recruitment_request'])]}"/>  -->
                                                <field name="date_expected" string="Deadline Date" attrs="{'readonly': [('state', '!=', 'submit')]}"/>
                                                 <!-- attrs="{'required':[('memo_type_key','in',['recruitment_request'])]}"/>  -->
                                            </group>
                                        </group>
                                    </sheet>
                                </form>
                            </page>

                            <page name='server_request_page' string='Server Request information' attrs="{'invisible':[('memo_type_key','not in',['server_access'])]}">
                                <form string=""> 
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="request_date" attrs="{'readonly':[('state','not in',['submit'])]}"/>
                                                <field name="request_end_date" attrs="{'readonly':[('state','not in',['submit'])]}"/>
                                                <field name="applicationChange" attrs="{'readonly':[('state','not in',['submit'])]}"/> 
                                                <field name="datapatch" attrs="{'readonly':[('state','not in',['submit'])]}"/> 
                                                <field name="enhancement" attrs="{'readonly':[('state','not in',['submit'])]}"/> 
                                                <field name="databaseChange" attrs="{'readonly':[('state','not in',['submit'])]}"/> 
                                                <field name="osChange" attrs="{'readonly':[('state','not in',['submit'])]}"/> 
                                            </group>
                                            <group>
                                                <field name="ids_on_os_and_db" attrs="{'readonly':[('state','not in',['submit'])]}"/> 
                                                <field name="versionUpgrade" attrs="{'readonly':[('state','not in',['submit'])]}"/> 
                                                <field name="otherChangeOption" attrs="{'readonly':[('state','not in',['submit'])]}"/>
                                                <field name="other_system_details" attrs="{'readonly':[('state','not in',['submit'])]}"/>
                                                <field name="justification_reason" attrs="{'readonly':[('state','not in',['submit'])]}"/>
                                            </group>
                                        </group>
                                    </sheet>
                                </form>
                            </page>
                            <page name='vehicle_trips' string='Vehicle trip' attrs="{'invisible':[('memo_type_key','not in',['vehicle_request'])]}">
                                <field name="vehicle_trip_ids" string = "Vehicle trip" readonly="1" force_save="1"
                                context="{'default_memo_id': active_id, 'default_code': code}">
                                    <tree string="Trips">
                                        <field name="code"/> 
                                        <field name="vehicle_assigned"/> 
                                        <field name="driver_assigned"/> 
                                        <field name="source_location_id"/> 
                                        <field name="source_destination_id"/> 
                                        <field name="start_time" readonly="1"/>
                                        <field name="end_time" readonly="1"/>
                                        <field name="trip_started" readonly="1" string="Trip Started?"/>
                                        <button name="action_start_fleet" confirm="Are you sure you want to complete this trip" string="Start trip" type="object" class="btn-sm oe_highlight" attrs="{'invisible': [('trip_started', '=', True)]}"/>
                                        <button name="action_end_fleet" string="End trip" confirm="Are you sure you want to end this trip" type="object" class="btn-sm oe_highlight" attrs="{'invisible': ['|',('end_time', '!=', False),('trip_started', '=', False)]}"/>
                                    </tree>
                                    <form string=""> 
                                        <sheet>
                                            <group>
                                                <group>
                                                    <field name="vehicle_assigned" readonly="0"/> 
                                                    <field name="driver_assigned" readonly="0" attrs="{'required': [('vehicle_assigned', '!=', False)]}"/> 
                                                    <field name="source_location_id" readonly="0" required="1"/> 
                                                    <field name="source_destination_id" readonly="0"  required="1"/> 
                                                    <field name="start_time" readonly="1"/>
                                                    <field name="end_time" readonly="1"/>
                                                    <field name="distance_covered" readonly="0"/>
                                                    <field name="distance_measured" readonly="0"/>
                                                    
                                                </group>
                                                <group> 
                                                    
                                                    <field name="number_of_days_covered" readonly="1"/>
                                                    <field name="volume_of_current_fuel" readonly="1"/>
                                                    <field name="volume_of_extra_fuel_used" readonly="0"/>
                                                    <field name="total_fuel_used" readonly="1"/>
                                                    <field name="incident_report" readonly="0" placeholder="Add Notes..." widget="html"/>
                                                    <field name="require_maintenance" readonly="0"/>
                                                    <field name="state_maintenace_required" readonly="0" placeholder="Add Notes..." widget="html"
                                                    attrs="{'invisible': [('require_maintenance', '=', False)], 
                                                    'required': [('require_maintenance', '=', True)]}"
                                                    />
                                                </group>
                                            </group>
                                        </sheet>
                                    </form>
                                </field>
                            </page> 
                            <page name="PurchaseOrder" string="Purchase Order" attrs="{'invisible': [('memo_type_key','in', ['leave_request'])]}">
                                <field name="po_ids" force_save="1"
                                context="{'default_memo_id': active_id, 'default_memo_state': state, 'default_partner_id': client_id, 'default_memo_type': memo_type, 'default_memo_type_key': memo_type_key}">
                                    <tree string="PO">
                                        <field name="memo_state" string="Memo State" column_invisible="1"/> 
                                        <field name="memo_type_key" string="memo key" column_invisible="1"/>  
                                        <field name="memo_id" string="Memo" column_invisible="1"/> 
                                        <field name="memo_type" string="Memo type" column_invisible="1"/> 
                                        <field name="name" string="PO Number"/>
                                        <field name="state" string="PO Status"/>
                                        <field name="amount_total" string="Total"/>
                                        <!-- <field name="is_shipped" column_invisible="1"/> -->
                                        <!-- <field name="incoming_picking_count" widget="statinfo" column_invisible="1" string="Receipt" help="Incoming Shipments"/> -->
                                        <button name="button_confirm" type="object" attrs="{'invisible': [('state', 'not in', ['draft', 'sent'])]}" string="Confirm Order" context="{'validate_analytic': True}" class="oe_highlight" id="bid_confirm" data-hotkey="q"/>
                                        <!-- invisible="state not in ('purchase', 'done')" data-hotkey="y" groups="stock.group_stock_user"/> -->
                                    </tree>
                                     
                                </field>
                            </page>
                            <page name="sub_stages" string="Sub Tasks" attrs="{'invisible': [('memo_type_key','in', ['leave_request'])]}">
                                <!-- invisible="not has_sub_stage"> -->
                                <field name="memo_sub_stage_ids">
                                    <tree string="Sub tasks">
                                        <field name="name"/>
                                        <field name="description" invisible="0"/>
                                        <field name="approver_ids" widget="many2many_tags" readonly="1"/>
                                        <field name="memo_id" invisible="1" column_invisible="1"/>
                                        <!-- <field name="sub_stage_id" invisible="0"/> -->
                                        <field name="sub_stage_done" invisible="0" readonly="1"/>
                                        <button name="confirm_sub_stage_done" string="Confirm" class="oe_highlight btn-sm" type="object"/>
                                    </tree>
                                    <form string="Sub tasks">
                                        <group>
                                            <group>
                                                <field name="name"/>
                                                <field name="memo_id" invisible="1" />
                                            </group>
                                            <group>
                                                <field name="sub_stage_done" invisible="0" readonly="1"/>
                                                <field name="sub_stage_id" invisible="1"/>
                                            </group>
                                            <notebook>
                                                <page name="Invoices" string="Finances">
                                                    <field name="invoice_ids" context="{'default_move_type': 'in_invoice', 'default_memo_id': active_id, 'form_view_ref': 'account.view_move_form'}">
                                                        <tree string="Invoices">
                                                            <field name="memo_id" string="Memo" invisible="1" column_invisible="1"/>  
                                                            <field name="memo_state" string="Memo state" invisible="1" column_invisible="1"/>  
                                                            <field name="name" string="#" invisible="0"/>  
                                                            <field name="partner_id" string="Beneficiary" invisible="0"/> 
                                                            <field name="move_type" string="Type" invisible="1" column_invisible="1"/> 
                                                            <field name="ref" string="Ref" invisible="1" column_invisible="1"/>  
                                                            <field name="date" string="Date" invisible="1" column_invisible="1"/> 
                                                            <field name="journal_id" string="Payment journal" required="0"/>  
                                                            <field name="amount_total" string="Amount" invisible="0"/> 
                                                            <field name="state" string="Status" invisible="1" column_invisible="1"/> 
                                                            <field name="stage_invoice_name" invisible="1" column_invisible="1"/> 
                                                            <button name="action_post" string="Post" class="oe_highlight btn-sm" type="object" attrs="{'invisible':[('memo_state','!=', 'Approve')]}" groups="account.group_account_invoice,base.group_system,company_memo.mainmemo_account,account.group_account_manager"/>
                                                            <field name="payment_state" string="Payment Status" invisible="0"/>  
                                                            <button name="action_register_payment" id="account_invoice_payment_btn" type="object" class="oe_highlight btn-sm" attrs="{'invisible':['|','|', ('memo_state','!=', 'Approve'),('state','!=', 'posted'), ('payment_state','!=', 'not_paid'),  ('move_type','not in', ['out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'])]}"
                                                            string="Register Payment" groups="account.group_account_invoice,base.group_system,company_memo.mainmemo_account,account.group_account_manager"/>
                                                        </tree>
                                                    </field>
                                                </page>
                                                <page name="attachment" string="Attachments">
                                                    <field name="attachment_ids" string="Attachment" domain="[('id', '=', None)]" context="{'default_res_model': 'memo.model', 'default_res_id': active_id, 'default_public': True}">
                                                        <tree string="Attachment">
                                                        
                                                            <field name="stage_document_name" string="Required Documents"/> 
                                                            <field name="name" string="Document Name"/> 
                                                            <field name="datas" filename="name" string="File"/>
                                                            <field name="stage_document_required" string="Is Compulsory"/>
                                                            <field name="is_locked" string="Locked?" invisible="0" />
                                                        </tree>
                                                        <form string="Attachment">
                                                            <group>
                                                                <group>
                                                                    <field name="stage_document_name" string="Required Documents" readonly="1" force_save="1"/> 
                                                                    <field name="name" string="Document Name" attrs="{'readonly': [('is_locked', '=', True)]}"/> 
                                                                </group>
                                                                <group>
                                                                    <field name="datas" filename="name" string="File" attrs="{'readonly': [('is_locked', '=', True)]}"/>
                                                                    <field name="stage_document_required" string="Is Compulsory" readonly="1" force_save="1"/> 
                                                                    <field name="is_locked" string="Locked?" invisible="1"/> 
                                                                </group>
                                                            </group>
                                                        </form>
                                                    </field>
                                                </page>
                                                
                                            </notebook>
                                        </group>
                                    </form>
                                </field>
                            </page>
                            <page name="attachment" string="Attachments">
                                <field name="attachment_ids" string="Attachment" domain="[('id', '=', None)]" 
                                context="{'default_res_model': 'memo.model', 'default_res_id': active_id, 'default_public': True}">
                                    <tree string="Attachment">
                                        <field name="stage_document_name" string="Required Documents"/> 
                                        <field name="name" string="Document Name"/> 
                                        <field name="datas" filename="name" string="File"/>
                                        <field name="stage_document_required" string="Is Compulsory"/>
                                        <field name="is_locked" string="Locked?" invisible="1"/>
                                    </tree>
                                    <form string="Attachment">
                                        <group>
                                            <group>
                                                <field name="stage_document_name" string="Required Documents" readonly="1" force_save="1"/> 
                                                <field name="name" string="Document Name" attrs="{'readonly': [('is_locked', '=', True)]}"/> 
                                            </group>
                                            <group>
                                                <field name="datas" filename="name" string="File" attrs="{'readonly': [('is_locked', '=', True)]}"/>
                                                <field name="stage_document_required" string="Is Compulsory" readonly="1" force_save="1"/> 
                                                <field name="is_locked" string="Locked?" invisible="1"/> 
                                            </group>
                                        </group>
                                    </form>
                                </field>
                            </page>
                            <page name='comments' string='Comments'>
                                <field name="comments" readonly="1" string = "Comments" placeholder="Notes..." widget="html" attrs="{'readonly':[('state','in',['Done', 'Approve'])]}"/>
                            </page>
                            <page name='supervisor_comments' string="Supervisor's Comments">
                                <field name="is_supervior" readonly="0" invisible="1"/>
                                <field name="supervisor_comment" string = "Supervisor Comments" placeholder="Notes..." widget="html" attrs="{'readonly':[('is_supervior','=',False)]}"/>
                            </page>
                            <page name='manager_comment' string="Manager's Comments">
                                <field name="is_manager" readonly="0" invisible="1"/>
                                <field name="manager_comment" readonly="0" string = "Manager Comments" placeholder="Notes..." widget="html" attrs="{'readonly':[('is_manager','=',False)]}"/>
                            </page>
- 
                            <page name='reason_backs' string='Return Reason'>
                                <field name="reason_back" readonly = "0" string = "Add Notes" placeholder="Notes..." widget="html" attrs="{'readonly':[('state','in',['Done', 'Approve'])]}"/>
                            </page>
                            <page invisible="1">
                                <field name="computed_stage_ids" invisible="0"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
						<field name="message_follower_ids" widget="mail_followers"/>
						<field name="message_ids" widget="mail_thread"/>
					</div>
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="tree_memo_model_view2">
            <field name="name">Internal Memo Tree</field>
            <field name="model">memo.model</field>
            <field name="priority">50</field>
            <field name="arch" type="xml">
                <tree string="Memo Requests">
                    <field name="date"/> 
                    <field name="name"/>
                    <field name="employee_id"/>
                    <field name="set_staff" string = "Memo With?"/>
                    <field name="code"/> 
                    <field name="state"/>
                    <field name="stage_id"/>
                    <field name="status_progress" widget="progressbar" string="Progress(%)"/>
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="main_memo_model_search_view">
            <field name="name">Internal Memo Request Search</field>
            <field name="model">memo.model</field>
            <field name="arch" type="xml">
                <search string="Internal Memo Filter"> 
                    <field name="name"/>
                    <field name="dept_ids"/>
                    <field name="vendor_id" string="Vendor"/>
                    <field name="employee_id"/>
                    <field name="project_id"/>
                    <field name="code"/> 
                    <field name="date" /> 
                    <group expand="0" string="Group By">
                        <filter name="name" string="Name" icon="terp-personal" domain="[]" context="{'group by':'name'}" />
                        <filter name="Approve" string="Approve" icon="terp-personel" domain="[('state','=', 'Approve')]" context="{'group by':'state'}" />
                        <filter name="Sent" string="Sent" icon="terp-personel" domain="[('state','=', 'Sent')]" context="{'group by':'state'}" />
                        <filter name="Done" string="Done" icon="terp-personel" domain="[('state','=', 'Done')]" context="{'group by':'state'}" />
                        <filter name="group_to_create_document" string="Status" domain="[]" context="{'group_by' : 'stage_id'}"/>
                        <filter name="Date" string="Date" icon="terp-personal" domain="[]" context="{'group by':'date'}" />
                    </group>
                </search>
            </field>
        </record>

      <!-- <record id="memo_back_wizard" model="ir.ui.view">
            <field name="name">Memo Back</field>
            <field name="model">send.memo.back</field>
            <field name="arch" type="xml">
                <form String="Reason for Returning">
                    <group>
                        <group>
                            <field name="memo_record" readonly="1"/>
                            <field name="date"/>
                        </group>
                        <group>
                            <field name="resp" readonly="0"  invisible="1"/>
                            <field name="direct_memo_user" string ="Initiator"/>
                        </group>
                            <field name="reason" placeholder="Please Add Reason(s) ..." colspan="4"/>
                    <footer>
                        <button name="post_back" type="object" string="Return" class="oe_highlight"/>
                            <button string="Cancel" class="oe_link" special="cancel"/>
                        </footer>
                    </group>
                </form>
            </field>
        </record> -->

<!--####################3-->  
        <record model="ir.actions.act_window" id="internal_memo_model_document_action">
            <field name="name">Documents Request</field>
            <field name="res_model">memo.model</field>
            <field name="type">ir.actions.act_window</field>
           <field name="domain">[('to_create_document','=',True)]</field>
            <field name="context">{'search_default_group_to_create_document': 1, 'default_to_create_document': True}</field>
             <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.actions.act_window" id="internal_memo_model_document_action2">
            <field name="name">Documents Request</field>
            <field name="res_model">memo.model</field>
            <field name="type">ir.actions.act_window</field>
           <field name="domain">[('to_create_document','=',True)]</field>
            <field name="context">{'search_default_group_to_create_document': 1, 
                'default_to_create_document': True, 
                'is_doc_mgt_request': True
            }
            </field>
             <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.actions.act_window" id="internal_memo_model_action">
            <field name="name">Internal Memo Request</field>
            <field name="res_model">memo.model</field>
            <field name="type">ir.actions.act_window</field>
           <!-- <field name="domain">[('is_house','=',True)]</field>
            <field name="context">{'search_default_project_type_grp': 1, 'search_default_building_type_grp': 1}</field>
            <field name="search_view_id" ref="view_building_type_search_filter"/> -->
             <field name="view_mode">tree,form</field>
        </record>
        
        <record model="ir.actions.act_window" id="internal_memo_action_sent">
            <field name="name">Internal Memo Request</field>
            <field name="res_model">memo.model</field>
            <field name="domain">[('state', '=', 'Sent')]</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.actions.act_window" id="internal_memo_action_Approve">
            <field name="name">Internal Memo Request</field>
            <field name="res_model">memo.model</field>
            <field name="domain">[('state', '=', 'Approve')]</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.actions.act_window" id="memo_model_refuse_action">
            <field name="name">Internal Memo Request</field>
            <field name="res_model">memo.model</field>
            <field name="domain">[('state', '=', 'Refuse')]</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.actions.act_window" id="internal_memo_action_done">
            <field name="name">Internal Memo Request</field>
            <field name="res_model">memo.model</field>
            <field name="domain">[('state', '=', 'Done')]</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.actions.act_window" id="loan_request_action">
            <field name="name">Loan Request</field>
            <field name="res_model">memo.model</field>
            <field name="domain">[('memo_type_key', '=', 'loan')]</field>
            <!-- <field name="context">{'default_memo_type': 'loan'}</field> -->
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">tree,form</field>
        </record>

        <menuitem id="internal_memo_menu_model_main2" name="Office Memo" groups="base.group_system,company_memo.mainmemo_manager,company_memo.mainmemo_account,company_memo.mainmemo_officer" action = "internal_memo_model_action" sequence = "2" web_icon="company_memo,static/description/icon.png"/>
        <record model="ir.actions.act_url" id="action_memo_open_my_request_url">
            <field name="name">Open URL for the</field>
            <field name="url">/my/requests</field>
            <field name="target">new</field>
        </record>

        <record id="documents.menu_root" model="ir.ui.menu">
            <field name="name">Documents Mgt System</field>
            <field name="groups_id" eval="[(6, 0, [ref('documents.group_documents_user')])]"/>
        </record>

        <menuitem id="internal_memo_menu_model_1" name="Office Memo Type"
        parent="internal_memo_menu_model_main2" sequence="3" groups="base.group_system,company_memo.mainmemo_manager,company_memo.mainmemo_account,company_memo.mainmemo_officer"/>
            <!-- parent="internal_memo_menu_model_main2" groups="base.group_system,company_memo.mainmemo_manager,company_memo.mainmemo_account,company_memo.mainmemo_officer"/> -->
            <menuitem id="internal_memo_menu_model2" sequence= "1" name="Memo Requests"
            parent="internal_memo_menu_model_1" action="internal_memo_model_action" groups="base.group_system,company_memo.mainmemo_manager,company_memo.mainmemo_account,company_memo.mainmemo_officer"/>

            <menuitem id="internal_memo_menu_sent" name="To Approve"
            parent="internal_memo_menu_model_1" sequence= "2" action = "internal_memo_action_sent"/>

            <menuitem id="internal_memo_model_approve" name="Approved"
            parent="internal_memo_menu_model_1" sequence= "3" action = "internal_memo_action_Approve"/>

            <menuitem id="internal_memo_model_done" name="Done"
            parent="internal_memo_menu_model_1" sequence= "4" action = "internal_memo_action_done"/>

            <menuitem id="internal_memo_model_id_refuse" name="Refuse"
            parent="internal_memo_menu_model_1" sequence= "5" action = "memo_model_refuse_action"/>

            <menuitem id="internal_memo_document_menu_model" name="Document Request"
            parent="internal_memo_menu_model_main2" sequence="4"/>
            <menuitem id="internal_memo_menu_document_request" sequence= "5" name="Submission Requests"
            parent="internal_memo_document_menu_model" action="internal_memo_model_document_action"/>
            
        <menuitem parent="internal_memo_menu_model_main2" id="menu_memo_website_request" name="Website Request(s)" action="action_memo_open_my_request_url" sequence="5"/>

        <!-- Document Mgt Requests Menu -->
        <menuitem id="internal_document_request_menu_model" name="Document Request"
            parent="documents.menu_root" groups="documents.group_documents_user" sequence="-1"/>
        <menuitem id="internal_document_request" sequence= "2" name="Submission Requests"
        parent="internal_document_request_menu_model" groups="documents.group_documents_user" action="internal_memo_model_document_action2"/>

    </data>
</odoo>
